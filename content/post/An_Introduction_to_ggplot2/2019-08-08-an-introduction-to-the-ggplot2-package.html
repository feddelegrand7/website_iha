---
title: 'An Introduction to the ggplot2 package. '
author: admin
date: '2019-08-08'
slug: an-introduction-to-the-ggplot2-package
categories: []
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: '2019-08-08T01:12:03+02:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<p>The <a href="https://ggplot2.tidyverse.org/">ggplot2</a> package integrates the <strong>tidy</strong> philosophy of programming introduced mainly by <a href="https://twitter.com/hadleywickham">Hadley Wickham</a>. It is part of the <strong>tidyverse</strong> package which includes several other packages related to the tidy world. Through this is tutorial, we’ll present some basic ggplot functionalities using the <strong>mtcars</strong> data base.</p>
<p>First of of all, you need to install the ggplot2 package which can be done either by</p>
<pre class="r"><code>install.packages(&quot;tidyverse&quot;)</code></pre>
<p>or</p>
<pre class="r"><code>install.packages(&quot;ggplot2&quot;)</code></pre>
<div id="plotting-with-ggplot" class="section level1">
<h1>Plotting with ggplot</h1>
<p>The mtcars object is a dataframe included in R that displays 10 aspects of automobile design and performance for 32 automobiles (1973–74 models). Let us have a quick overview of the mtcars dataset.</p>
<pre class="r"><code>head(mtcars)</code></pre>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>We want to plot the relation between the miles per galon <em>(mpg)</em> and the weights <em>(wt)</em> of our cars’ models. To do that in ggplot2 one need to identify three principal elements (or two depending on your desired graph): The <em>database</em> from which the information will be extracted, the <em>x-axis variable</em> and the <em>y-axis variable</em>.</p>
<pre class="r"><code>library(ggplot2) # or library(tidyverse)

ggplot(data = mtcars, mapping = aes(x = mpg, y = wt))</code></pre>
<p><img src="/post/An_Introduction_to_ggplot2/2019-08-08-an-introduction-to-the-ggplot2-package_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>In the exemple above, we used the function <strong>ggplot</strong> and two parameters <em>data </em> and <em>mapping</em> to structure our graph. The <em>mapping</em> parameters determine which variable should be considered in which axis. To plot our volue we need to add another argument to our code. Suppose we want to plot a scatterplot :</p>
<pre class="r"><code>ggplot(data = mtcars, mapping = aes(x = mpg, y = wt)) +
  geom_point()   # geom_point() refers to scatterplot</code></pre>
<p><img src="/post/An_Introduction_to_ggplot2/2019-08-08-an-introduction-to-the-ggplot2-package_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>To modify the size of the color of the displayed points, we just introduce the following parameters in the geom_point() function :</p>
<pre class="r"><code>ggplot(data = mtcars, mapping = aes(x = mpg, y = wt)) +
  geom_point(size = 3, color = &quot;red&quot;)   # geom_point() refers to scatterplot</code></pre>
<p><img src="/post/An_Introduction_to_ggplot2/2019-08-08-an-introduction-to-the-ggplot2-package_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>For an exhaustive list of R colours, just check this <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">website</a>.
Now, if we want to modify the theme of our plot, proceed as follow :</p>
<pre class="r"><code>ggplot(data = mtcars, mapping = aes(x = mpg, y = wt)) +
  geom_point(size = 3, color = &quot;red&quot;) + 
  theme_bw()  #just tape theme and wait to see several choices</code></pre>
<p><img src="/post/An_Introduction_to_ggplot2/2019-08-08-an-introduction-to-the-ggplot2-package_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>finally, it is possible to assign a plot to a defined variable :</p>
<pre class="r"><code>plot1 &lt;- ggplot(data = mtcars, mapping = aes(x = mpg, y = wt)) +
  geom_point(size = 3, color = &quot;red&quot;) + 
  theme_bw()  </code></pre>
</div>
<div id="plotting-interactively-with-plotly" class="section level1">
<h1>Plotting Interactively with Plotly</h1>
<p>Plotly is an interesting package that allows us to create interactive web graphics from ggplot2. Just convert our above scatterplot into an interactive one, just use the function <strong>ggplotly</strong> :</p>
<pre class="r"><code>library(plotly)  # Load the package after installing it

ggplotly(plot1)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[21,21,22.8,21.4,18.7,18.1,14.3,24.4,22.8,19.2,17.8,16.4,17.3,15.2,10.4,10.4,14.7,32.4,30.4,33.9,21.5,15.5,15.2,13.3,19.2,27.3,26,30.4,15.8,19.7,15,21.4],"y":[2.62,2.875,2.32,3.215,3.44,3.46,3.57,3.19,3.15,3.44,3.44,4.07,3.73,3.78,5.25,5.424,5.345,2.2,1.615,1.835,2.465,3.52,3.435,3.84,3.845,1.935,2.14,1.513,3.17,2.77,3.57,2.78],"text":["mpg: 21.0<br />wt: 2.620","mpg: 21.0<br />wt: 2.875","mpg: 22.8<br />wt: 2.320","mpg: 21.4<br />wt: 3.215","mpg: 18.7<br />wt: 3.440","mpg: 18.1<br />wt: 3.460","mpg: 14.3<br />wt: 3.570","mpg: 24.4<br />wt: 3.190","mpg: 22.8<br />wt: 3.150","mpg: 19.2<br />wt: 3.440","mpg: 17.8<br />wt: 3.440","mpg: 16.4<br />wt: 4.070","mpg: 17.3<br />wt: 3.730","mpg: 15.2<br />wt: 3.780","mpg: 10.4<br />wt: 5.250","mpg: 10.4<br />wt: 5.424","mpg: 14.7<br />wt: 5.345","mpg: 32.4<br />wt: 2.200","mpg: 30.4<br />wt: 1.615","mpg: 33.9<br />wt: 1.835","mpg: 21.5<br />wt: 2.465","mpg: 15.5<br />wt: 3.520","mpg: 15.2<br />wt: 3.435","mpg: 13.3<br />wt: 3.840","mpg: 19.2<br />wt: 3.845","mpg: 27.3<br />wt: 1.935","mpg: 26.0<br />wt: 2.140","mpg: 30.4<br />wt: 1.513","mpg: 15.8<br />wt: 3.170","mpg: 19.7<br />wt: 2.770","mpg: 15.0<br />wt: 3.570","mpg: 21.4<br />wt: 2.780"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":31.4155251141553},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[9.225,35.075],"tickmode":"array","ticktext":["10","15","20","25","30","35"],"tickvals":[10,15,20,25,30,35],"categoryorder":"array","categoryarray":["10","15","20","25","30","35"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"mpg","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.31745,5.61955],"tickmode":"array","ticktext":["2","3","4","5"],"tickvals":[2,3,4,5],"categoryorder":"array","categoryarray":["2","3","4","5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"wt","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"28fc8b1c58":{"x":{},"y":{},"type":"scatter"}},"cur_data":"28fc8b1c58","visdat":{"28fc8b1c58":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Several functionalities appear in the top-right of the plot.</p>
<div id="plotting-distributions-with-histograms" class="section level2">
<h2>Plotting Distributions with Histograms</h2>
<p>Histogram are suitable for plotting a continous variable. If you want to make a histogram use <strong>geom_histogram</strong>:</p>
<pre class="r"><code>ggplot(data = mtcars, mapping = aes(x = mpg)) +
  geom_histogram()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/post/An_Introduction_to_ggplot2/2019-08-08-an-introduction-to-the-ggplot2-package_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We can change the size of the bins using the <em>binwidth</em> parameter :</p>
<pre class="r"><code>ggplot(data = mtcars, mapping = aes(x = mpg)) +
  geom_histogram(binwidth = 3)</code></pre>
<p><img src="/post/An_Introduction_to_ggplot2/2019-08-08-an-introduction-to-the-ggplot2-package_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>By default, the data is grouped into 30 bins. To can change the number of bins, we use the parameter <strong>bins</strong>:</p>
<pre class="r"><code>ggplot(data = mtcars, mapping = aes(x = mpg)) +
  geom_histogram(bins = 6)</code></pre>
<p><img src="/post/An_Introduction_to_ggplot2/2019-08-08-an-introduction-to-the-ggplot2-package_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>To modify the color of the histogram, just proceed as follows:</p>
<pre class="r"><code>ggplot(data = mtcars, mapping = aes(x = mpg)) +
  geom_histogram(fill = &quot;pink&quot;, color = &quot;yellow&quot;) # Mind the difference</code></pre>
<p><img src="/post/An_Introduction_to_ggplot2/2019-08-08-an-introduction-to-the-ggplot2-package_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>We can also use the plotly package to plot an interactive histogram.</p>
<pre class="r"><code>histogram &lt;- ggplot(data = mtcars, mapping = aes(x = mpg)) +
  geom_histogram(fill = &quot;pink&quot;, color = &quot;yellow&quot;) 

ggplotly(histogram)</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"data":[{"orientation":"v","width":[0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586206,0.810344827586221,0.810344827586206,0.810344827586206],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[10.5344827586207,11.3448275862069,12.1551724137931,12.9655172413793,13.7758620689655,14.5862068965517,15.3965517241379,16.2068965517241,17.0172413793103,17.8275862068965,18.6379310344828,19.448275862069,20.2586206896552,21.0689655172414,21.8793103448276,22.6896551724138,23.5,24.3103448275862,25.1206896551724,25.9310344827586,26.7413793103448,27.551724137931,28.3620689655172,29.1724137931034,29.9827586206897,30.7931034482759,31.6034482758621,32.4137931034483,33.2241379310345,34.0344827586207],"y":[2,0,0,1,0,2,5,1,1,2,1,3,0,4,1,2,0,1,0,1,0,1,0,0,0,2,0,1,0,1],"text":["count: 2<br />mpg: 10.53448","count: 0<br />mpg: 11.34483","count: 0<br />mpg: 12.15517","count: 1<br />mpg: 12.96552","count: 0<br />mpg: 13.77586","count: 2<br />mpg: 14.58621","count: 5<br />mpg: 15.39655","count: 1<br />mpg: 16.20690","count: 1<br />mpg: 17.01724","count: 2<br />mpg: 17.82759","count: 1<br />mpg: 18.63793","count: 3<br />mpg: 19.44828","count: 0<br />mpg: 20.25862","count: 4<br />mpg: 21.06897","count: 1<br />mpg: 21.87931","count: 2<br />mpg: 22.68966","count: 0<br />mpg: 23.50000","count: 1<br />mpg: 24.31034","count: 0<br />mpg: 25.12069","count: 1<br />mpg: 25.93103","count: 0<br />mpg: 26.74138","count: 1<br />mpg: 27.55172","count: 0<br />mpg: 28.36207","count: 0<br />mpg: 29.17241","count: 0<br />mpg: 29.98276","count: 2<br />mpg: 30.79310","count: 0<br />mpg: 31.60345","count: 1<br />mpg: 32.41379","count: 0<br />mpg: 33.22414","count: 1<br />mpg: 34.03448"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,192,203,1)","line":{"width":1.88976377952756,"color":"rgba(255,255,0,1)"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":31.4155251141553},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[8.91379310344827,35.6551724137931],"tickmode":"array","ticktext":["10","15","20","25","30","35"],"tickvals":[10,15,20,25,30,35],"categoryorder":"array","categoryarray":["10","15","20","25","30","35"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"mpg","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.25,5.25],"tickmode":"array","ticktext":["0","1","2","3","4","5"],"tickvals":[0,1,2,3,4,5],"categoryorder":"array","categoryarray":["0","1","2","3","4","5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"28fc3c017b6c":{"x":{},"type":"bar"}},"cur_data":"28fc3c017b6c","visdat":{"28fc3c017b6c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="filling-histograms-with-categories" class="section level1">
<h1>Filling Histograms with Categories</h1>
<p>Suppose we are interested in ploting the distribution of the miles per gallon (mpg) variable but this time we want to differentiate between automatic and manuel cars (am : 0 = automatic, 1 = manual). First of all, we must convert the <em>am</em> column into a factor variable:</p>
<pre class="r"><code>mtcars$am &lt;- factor(mtcars$am, labels = c(&quot;Automatic&quot;, &quot;Manual&quot;)) # We provide labels 

ggplot(data = mtcars, mapping = aes(x = mpg, fill = am)) +
  geom_histogram() </code></pre>
<p><img src="/post/An_Introduction_to_ggplot2/2019-08-08-an-introduction-to-the-ggplot2-package_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>From the above histogram, we observe that manual vehicules have a higher <em>mpg</em> performance.</p>
</div>
<div id="splitting-plots-with-facets" class="section level1">
<h1>Splitting Plots with Facets</h1>
<p>We show above how to plot a distribution according to a specific category. One may proceed otherwise and generate two distinc plots using <strong>Face_grid()</strong> :</p>
<pre class="r"><code>ggplot(data = mtcars, mapping = aes(x = mpg)) +
  geom_histogram(fill = &quot;yellow&quot;, color = &quot;pink&quot;) +
  facet_grid(~am) +
  theme_light()</code></pre>
<p><img src="/post/An_Introduction_to_ggplot2/2019-08-08-an-introduction-to-the-ggplot2-package_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
